# Clean Architectureを理解する

## 資料集

- [クリーンアーキテクチャなんてものはない（クリーンアーキテクチャーの読み方）](https://yyyank.blogspot.com/2021/06/there-is-no-clean-architecture.html)
  - 以下の4つの「大事なこと」を留意しておきたい
    - 本を読んで大事なところを自分なりに理解して行動してみよう（どの本でも大事）
    - the クリーンアーキテクチャの一枚絵にこだわりすぎないようにしよう（ただの例として捉える）
    - DIPをやろう
    - 依存の方向は一方向にしよう
- [世界一わかりやすいClean Architecture](https://www.nuits.jp/entry/easiest-clean-architecture-2019-09)
  - 議論がとても丁寧だと感じた。まとめだけでも時々振り返るといいかもしれない。
  - やっぱり依存性逆転が主立っているんだなぁと思った。そこを中心とした議論も注目かも。
  - いくつか大事なコメントを引用。
    - この図で本当に大切なことは、依存性は外から中だけに向かっていなくてはいけない、というたった一点にあります。
    - 「依存性は、より上位レベルの方針にのみ向けよ」「制御の流れと依存方向は分離しコントロールせよ」「上位レベルとは相対的・再帰的であることに留意せよ」
- [「依存性逆転の原則」と「依存性の注入」を完全に理解した](https://qiita.com/uhooi/items/03ec6b7f0adc68610426)
  - 自分も思っていた疑問に回答が与えられた感じがしたので、この記事は好き。
  - ネイティブアプリ向けの言語が例に用いられているので、正直自分はとっつきにくいのが少し残念。
  - 以下の2つのコメントが大事かも。
    - Bがインタフェースを提供し、Aがそれを実装してBに注入する場合、BはAに依存することなしにAを利用できますよね？普通はAを利用するためにはAに依存しないといけないところ（A←B）を、BはAに依存せずにAを利用し、逆にAがBのインタフェースを実装するためにBに依存する（A→B）のが「逆転」です。
    - 依存性を逆転させるには、制御の流れとしては上位にあるモジュールが、同じレイアに下位モジュールの抽象を作って、これに依存し、下位のモジュールは上位のレイア内で定義された抽象に依存し、その実装を作る必要があります。
- [良いコードとは何か](https://note.com/cyberz_cto/n/n26f535d6c575)
  - これも最後でClean Architectureを解説している、流石に正しい理解に基づいて解説されているように見える
  - 凝集度と結合度の話がより具体的・詳細な粒度で述べられていて、自分の中でコードの良し悪しの根拠が持ちやすいのは大変良いと思った。
    - このあたりの雰囲気は、書籍「リファクタリング」を想起した。
  - 以下は引用。
    - 品質とスピードはトレードオフではなく、むしろ正の相関がある。品質を上げることで、コードの変更速度が上がり、手戻りが減り、学びのルールが早くなり、市場での競争力が上がります。
    - 品質を上げるため必要なのは、知識、経験です。
    - たとえ理解が不完全だとしても目の前の問題に対する現時点での理解でコードを書くことはいいことです。一方で、現時点での理解を可能な限り反映させることが重要です。すなわち、意図的な負債を紛れさせるなと。そうすることで、リファクタリングするときに、新しく学んだ理解に合わせて容易にリファクタリングすることができます。
      - これは最近仕事をしながら実際に感じたし、納得感がある。
    - とにかく関数を分ければ良い、というものではありません。関数に分けることで、たしかに凝集度を高めることはできますが、同時に認知負荷が多少なりとも上昇します。意味のわかる単位で区切ることが重要です。
    - Clean Architectureで主張されているのは、この2つのルールだけになります。**1つ目は、レイヤーに分離し、関心事の分離を行う。2つ目は、それらの依存性は内側だけに向かっていなければいけないということです。**これらが守られているアーキテクチャが、クリーンなアーキテクチャとされています。
      - やはり。
    - 内側に近づくにつれ、ソフトウェアは抽象化され、一般的なものになる必要があります。
    - （内側から外側に情報を伝える）一つの方法は、RxやFlow等のストリームを使って、内側から外側にイベントを流す方法でしょう。MVVMのDataBindingもこれに当たります。この場合であっても、依存の方向は外側から内側のみになっています。
      - DIPだけが依存方向の制限方法だけだと思いこんでいたので、これは再認識しないといけない。確かに、慣れ親しんだVueのdata bindingもこれだった。
    - （境界線を超えるデータに関する注意事項として）2つ目は、内側が外側について知るようなデータを渡してはいけません。先程のUIProtocolも、UseCaseレイヤーの知識のみで作成する必要があります。
  - ただし、[ばんくしさんのこのツイート](https://twitter.com/vaaaaanquish/status/1498481409752637442)はちょっと大げさかなぁ、と思ってしまった。
    - 個人的には、これに匹敵する優れた文献や書籍も多くあると思った。また、鍛錬しないとちゃんと自分でかけるようにはならない、というのはいずれの文献も同様なはず。
